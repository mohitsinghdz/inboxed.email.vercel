---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { alternatives } from '../../data/seo-pages';
import type { AlternativesData, AlternativeEntry } from '../../data/seo-pages';

export function getStaticPaths() {
  return alternatives.map((data) => ({
    params: { slug: data.slug },
    props: { data },
  }));
}

const { data } = Astro.props as { data: AlternativesData };

const relatedAlternatives = alternatives
  .filter((a) => a.slug !== data.slug)
  .slice(0, 4);
---

<BaseLayout
  title={data.seo.title}
  description={data.seo.description}
  canonical={data.seo.canonical}
  schemas={[data.schema]}
>
  <div class="container-custom py-32">
    <div class="max-w-4xl mx-auto">
      <h1 class="font-serif text-5xl md:text-7xl mb-8 leading-tight">{data.h1}</h1>
      <p class="font-body text-xl md:text-2xl mb-16 max-w-2xl leading-relaxed text-mutedForeground">
        {data.intro}
      </p>

      <!-- Entries -->
      <div class="space-y-20">
        {data.entries.map((entry: AlternativeEntry) => (
          <section class={`border-t ${entry.isInboxed ? 'border-black border-t-4' : 'border-black/10'} pt-12`}>
            <div class="flex items-center gap-4 mb-6">
              <span class={`px-3 py-1 font-mono text-sm ${entry.isInboxed ? 'bg-black text-white' : 'bg-muted text-mutedForeground'}`}>
                #{entry.rank}{entry.isInboxed ? ' TOP PICK' : ''}
              </span>
              <h2 class="font-serif text-4xl">{entry.name}</h2>
            </div>
            <p class="font-body text-lg mb-8 leading-relaxed">{entry.description}</p>

            <div class="grid md:grid-cols-2 gap-8 mb-8">
              <div class="bg-muted/30 p-6">
                <h3 class="font-bold mb-4">✓ Pros</h3>
                <ul class="space-y-2 text-sm">
                  {entry.pros.map((pro) => (
                    <li>• {pro}</li>
                  ))}
                </ul>
              </div>
              <div class="bg-muted/30 p-6">
                <h3 class="font-bold mb-4 text-mutedForeground">✕ Cons</h3>
                <ul class="space-y-2 text-sm">
                  {entry.cons.map((con) => (
                    <li>• {con}</li>
                  ))}
                </ul>
              </div>
            </div>

            {entry.isInboxed ? (
              <a href="/" class="btn-primary inline-block">Try Inboxed Free</a>
            ) : entry.slug ? (
              <a
                href={`/compare/${entry.slug}`}
                class="text-black font-bold underline decoration-1 underline-offset-4 hover:decoration-2"
              >
                Read our comparison &rarr;
              </a>
            ) : null}
          </section>
        ))}
      </div>

      <!-- Methodology -->
      {data.methodology && (
        <div class="border-t border-black/10 mt-20 pt-16">
          <h2 class="font-serif text-3xl mb-6">How We Evaluated These Alternatives</h2>
          <p class="font-body text-lg leading-relaxed">{data.methodology}</p>
        </div>
      )}

      <!-- FAQ -->
      {data.faq && data.faq.length > 0 && (
        <div class="border-t border-black/10 mt-16 pt-16">
          <h2 class="font-serif text-3xl mb-10">Frequently Asked Questions</h2>
          <div class="space-y-8">
            {data.faq.map((item) => (
              <div>
                <h3 class="font-bold text-lg mb-2">{item.q}</h3>
                <p class="font-body leading-relaxed text-mutedForeground">{item.a}</p>
              </div>
            ))}
          </div>
        </div>
      )}

      <!-- Bottom CTA -->
      <div class="mt-32 p-12 bg-black text-white">
        <h2 class="font-serif text-4xl mb-6 text-center">Ready to make the switch?</h2>
        <p class="text-xl text-center mb-8 opacity-80">
          Join thousands of users who chose privacy and intelligence.
        </p>
        <div class="flex justify-center">
          <a href="/" class="bg-white text-black px-8 py-4 font-bold hover:bg-white/90 transition-colors">
            {data.cta}
          </a>
        </div>
      </div>

      <!-- Related Alternatives -->
      {relatedAlternatives.length > 0 && (
        <div class="border-t border-black/10 mt-20 pt-16">
          <h3 class="font-mono text-sm uppercase tracking-widest text-mutedForeground mb-8">More Alternatives</h3>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            {relatedAlternatives.map((a) => (
              <a
                href={`/alternatives/${a.slug}`}
                class="block p-4 border border-black/10 hover:border-black transition-colors"
              >
                <span class="font-body text-sm">{a.competitor} Alternatives</span>
              </a>
            ))}
          </div>
        </div>
      )}
    </div>
  </div>
</BaseLayout>
